<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Rapport</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<p><span class="smallcaps">ENSEIRB-MATMECA</span><br />
</p>
<p><img src="logo ecole.jpg" alt="image" /></p>
<hr />
<p><br />
<span><strong>Solving the linear Boltzmann equation using Monte Carlo methods</strong> </span><br />
</p>
<hr />
<p><br />
<span><strong></strong></span></p>
<p><span>Project lead by :</span><br />
<span>C. Aumonier, A. Boucher, G. Doyen, K. El Maddah, G. Rodiere</span></p>
<p><span>Project supervised by :</span><br />
<span>G. Poëtte</span></p>
<p><span>January 2024</span></p>
<h1 id="introduction">Introduction</h1>
<h2 id="terms-and-definitions">Terms and definitions</h2>
<p>The transport equation plays a crucial role in describing the behavior of particles in various physical systems. One of its important derivatives, the linear Boltzmann equation, is governed by the evolution of particle distribution in phase space. In this project, a numerical solution for the linear Boltzmann equation is developed utilizing the Monte Carlo method. The report is structured as follows:</p>
<ol>
<li><p><strong>Transport Equation:</strong> The fundamental transport equation is introduced, providing a basis for understanding the derivation of the linear Boltzmann equation.</p></li>
<li><p><strong>Linear Boltzmann Equation:</strong> Building upon the transport equation, the linear Boltzmann equation is explored, emphasizing its significance in characterizing particle transport phenomena.</p></li>
<li><p><strong>Monte Carlo Method for Linear Boltzmann Equation:</strong> The approach to solving the linear Boltzmann equation using the Monte Carlo method is presented, along with a discussion of the advantages and challenges associated with this numerical technique.</p></li>
<li><p><strong>Semi-Analog Monte Carlo Scheme:</strong> A semi-analog Monte Carlo scheme is introduced as an innovative strategy to enhance the efficiency and accuracy of simulations.</p></li>
</ol>
<h2 id="context-and-applications">Context and Applications</h2>
<p>The linear Boltzmann equation finds applications in a wide range of industrial and research contexts. Notable examples include its use in nuclear reactor physics, radiation shielding design, medical imaging, and astrophysics. Applications extend to industries such as nuclear energy, healthcare, and aerospace, where accurate simulations of particle transport are crucial for optimizing designs and ensuring safety protocols.</p>
<p>In the realm of academic research, the linear Boltzmann equation serves as a cornerstone in the study of rarefied gas dynamics, plasma physics, and neutron transport. Collaborations between universities, research institutions, and companies contribute to advancements in understanding and solving complex problems associated with particle transport phenomena.</p>
<p>This project aims to contribute to the broader understanding and application of the linear Boltzmann equation, with a focus on developing efficient numerical methods for solving this intricate problem.</p>
<h4 id="note">Note</h4>
<p>Here is a brief summary of the various existences and uniqueness of solutions based on different cases of equations to be solved. The primary source used is the transport and diffusion document.</p>
<h1 id="mathematical-analysis">mathematical analysis</h1>
<h2 id="transport-equation">Transport Equation</h2>
<h4 id="section"></h4>
<p>In this section, we will examine the solutions of the transport equation, a particular case of the Boltzmann equation, defined below:</p>
<p>Let’s <span class="math inline"><em>v</em> ∈ ℝ<sup><em>N</em></sup></span></p>
<p><br /><span class="math display">$$\label{transport}
    \frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x) + a(t,x)f(t,x) = S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.$$</span><br /></p>
<p><span class="math inline"><em>f</em></span> is the unknown function, <span class="math inline"><em>a</em></span> is the given damping or amplification rate, and <span class="math inline"><em>S</em></span> is the given source term.</p>
<h3 id="cauchy-problem">Cauchy Problem</h3>
<h4 id="special-case-without-absorption-or-source-term">Special Case without Absorption or Source Term</h4>
<p>Let’s consider the following Cauchy problem:</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)=0, \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
    f(0,x)) = f^{in}(x)
\end{cases}$$</span><br /></p>
<p>If <span class="math inline"><em>f</em><sup><em>i</em><em>n</em></sup> ∈ 𝒞<sup>1</sup>(ℝ<sup><em>n</em></sup>)</span>, then using the method of characteristics, we can easily demonstrate that the Cauchy problem has a unique solution <span class="math inline"><em>f</em> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × ℝ<sup><em>n</em></sup>)</span>. This solution is given as follows:</p>
<p><span class="math inline">$\boxed{f(t,x)=f^{in}(x-tv) \quad \forall (t,x) \in \mathbb{R}_+ \times \mathbb{R}^n }$</span></p>
<h4 id="with-absorption-and-source-term">With Absorption and Source Term</h4>
<p>This time, we consider damping and the source term, assuming they belong to <span class="math inline">𝒞<sup>1</sup>(ℝ<sub>+</sub> × ℝ<sup><em>n</em></sup>)</span>. The considered Cauchy problem is as follows:</p>
<p><br /><span class="math display">$$\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x) + a(t,x)f(t,x) = S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
f(0,x)) = f^{in}(x)
\end{cases}$$</span><br /></p>
<p>In this case, if <span class="math inline"><em>f</em><sup><em>i</em><em>n</em></sup> ∈ 𝒞<sup>1</sup>(ℝ<sup><em>n</em></sup>)</span>, then using the method of characteristics, we can still demonstrate that the Cauchy problem has a unique solution <span class="math inline"><em>f</em> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × ℝ<sup><em>n</em></sup>)</span>. This solution is given as follows:<br />
<span class="math inline">$\boxed{f(t,x)=f^{in}(x-tv) e^{-\int_0 ^t a(\tau,x+(t-\tau)v)d\tau} + \int_0 ^t  e^{-\int_0 ^t a(\tau,x+(t-\tau)v)d\tau} S(s,x+(s-t)v)ds \quad \forall (t,x) \in \mathbb{R}_+ \times \mathbb{R}^n }$</span></p>
<p>We will demonstrate the previous formula using the characteristics method. We will not demonstrate all folowing expression of the exact solution but the idea would be the same.</p>
<h4 id="section-1"></h4>
<p>We will demonstrate the previous formula using the method of characteristics. The proof of the following expression for the exact solution will not be elaborated upon, but the underlying idea would be analogous. The interested reader is invited to see <span style="color: red">Mettre la source allaire!!!!!</span>.</p>
<p>Let <span class="math inline"><em>y</em> ∈ ℝ</span>, and consider the characteristic curve emanating from <span class="math inline"><em>y</em></span> at <span class="math inline"><em>t</em> = 0</span>, given by :</p>
<p><br /><span class="math display">{(<em>t</em>, <em>γ</em>(<em>t</em>)), |<em>t</em> ≥ 0},  where <em>γ</em>(<em>t</em>)<em>y</em> + <em>t</em><em>v</em></span><br /></p>
<p>If <span class="math inline"><em>f</em> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × ℝ<sup><em>n</em></sup></span> is the solution of the previous Cauchy problem, then <span class="math inline"><em>t</em> ↦ <em>f</em>(<em>t</em>, <em>γ</em>(<em>t</em>))</span> is of <span class="math inline">𝒞<sup>1</sup></span> class on <span class="math inline">ℝ<sub>+</sub></span>, and</p>
<p><br /><span class="math display">$$\begin{aligned}
\frac{d f}{d t}(t,\gamma(t))&amp;=(\frac{\partial f}{\partial t}
v \cdot \nabla_x f(t,x))(t,\gamma(t)) \\ &amp;= S(t,\gamma(t))-a(t,\gamma(t))f(t,\gamma(t)), \quad t&gt;0.
\end{aligned}$$</span><br /></p>
<p>The previous partial differential equation reduces to an ordinary differential equation (ODE) of the form:</p>
<p><br /><span class="math display">$$\begin{cases}
u'(t)+\alpha(t)u(t)=\Sigma(t), \quad t&gt;0,\\
u(0)=u^{in}
\end{cases}$$</span><br /></p>
<p>The well-known solution is calculated using the constant variation method:</p>
<p><br /><span class="math display"><em>u</em>(<em>t</em>) = <em>u</em><sup><em>i</em><em>n</em></sup><em>e</em><sup> − <em>A</em>(<em>t</em>)</sup> + ∫<sub>0</sub><sup><em>t</em></sup><em>e</em><sup> − <em>A</em>(<em>t</em>) − <em>A</em>(<em>s</em>)</sup><em>Σ</em>(<em>s</em>)<em>d</em><em>s</em>,  with <em>A</em>(<em>t</em>) = ∫<sub>0</sub><sup><em>t</em></sup><em>α</em>(<em>τ</em>)<em>d</em><em>τ</em>.</span><br /></p>
<p>Then by applying this to the Cauchy problem along the characteristic curve from <span class="math inline"><em>y</em></span> at <span class="math inline"><em>t</em> = 0</span>, we obtain:</p>
<p><br /><span class="math display"><em>f</em>(<em>t</em>, <em>y</em> + <em>t</em><em>v</em>) = <em>f</em><sup><em>i</em><em>n</em></sup>(<em>y</em>)<em>e</em><sup>∫<sub>0</sub><sup><em>t</em></sup><em>a</em>(<em>τ</em>, <em>y</em> + <em>τ</em><em>v</em>)<em>d</em><em>τ</em></sup> + ∫<sub>0</sub><sup><em>t</em></sup><em>e</em><sup>∫<sub>0</sub><sup><em>t</em></sup><em>a</em>(<em>τ</em>, <em>y</em> + <em>τ</em><em>v</em>)<em>d</em><em>τ</em></sup><em>S</em>(<em>s</em>, <em>y</em> + <em>s</em><em>v</em>)<em>d</em><em>s</em>, <em>y</em> ∈ ℝ<sup><em>n</em></sup>, <em>t</em> ≥ 0.</span><br /></p>
<p>By replacing the dummy variable <span class="math inline"><em>y</em></span> with <span class="math inline"><em>x</em> − <em>t</em><em>v</em></span> we arrive the expected formula.</p>
<h3 id="boundary-value-problems">Boundary Value Problems</h3>
<p>In the previous section, we presented results applicable when considering complete freedom for the spatial variable in <span class="math inline">ℝ<sup><em>n</em></sup></span>. However, for a significant portion of physical problems, this may not be the case. That is why we are more interested in a problem of the boundary value type. In this section, we will consider the set <span class="math inline"><em>Ω</em></span>, which is an open set with a <span class="math inline">𝒞<sup>1</sup></span> boundary in <span class="math inline">ℝ<sup><em>n</em></sup></span>. Additionally, we take <span class="math inline"><em>v</em> ∈ ℝ<sup><em>n</em></sup> ∖ {0}</span>.</p>
<h4 id="special-case-without-absorption-or-source-term-1">Special Case without Absorption or Source Term</h4>
<h4 id="section-2"></h4>
<p>If, moreover, <span class="math inline"><em>Ω</em></span> is convex, and let <span class="math inline"><em>f</em><sub><em>b</em></sub><sup>−</sup> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × ∂<em>Ω</em><sup>−</sup>)</span> and <span class="math inline">$f^{in} \in \mathcal{C}^1(\overline{\Omega})$</span>, where <span class="math inline">∂<em>Ω</em><sup>−</sup> = {<em>x</em> ∈ ∂<em>Ω</em> | <em>v</em> ⋅ <em>n</em><sub><em>x</em></sub> &lt; 0}</span>, then the problem:</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)=0, \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}$$</span><br /></p>
<p>has a unique solution <span class="math inline"><em>f</em> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × <em>Ω</em>)</span> and <span class="math inline">$f \in \mathcal{C}^0(\mathbb{R}_+ \times \overline{\Omega})$</span> if and only if <span class="math inline">∀<em>y</em> ∈ ∂<em>Ω</em><sup>−</sup>,</span></p>
<p><br /><span class="math display">$$f_b^-(0,y) = f^{in}(y), \quad \frac{\partial f_b^-}{\partial t}(t,y)+v \cdot \nabla f^{in}(y)=0.$$</span><br /></p>
<h4 id="section-3"></h4>
<p>The expression of the solution is then given by: <br /><span class="math display">$$\boxed{
    f(t,x)= 
    \begin{cases}
        f^{in}(x-tv) \quad si~ t \leq \tau_x ,\\
        f_b^-(t-\tau_x,x-\tau_xv) \quad si~ t &gt; \tau_x ,
    \end{cases}
}$$</span><br /></p>
<p>With <span class="math inline">$\tau_x= \inf \{t \geq 0~ | ~ x-tv \notin \overline{\Omega}\}$</span></p>
<h4 id="with-absorption-and-source-term-1">With Absorption and Source Term</h4>
<h4 id="section-4"></h4>
<p>We still consider <span class="math inline"><em>Ω</em></span> to be convex, with <span class="math inline"><em>f</em><sub><em>b</em></sub><sup>−</sup> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × ∂<em>Ω</em><sup>−</sup>)</span>, <span class="math inline">$f^{in} \in \mathcal{C}^1(\overline{\Omega})$</span>, <span class="math inline"><em>a</em></span>, and <span class="math inline"><em>S</em></span> <span class="math inline">$\in \mathcal{C}^1(\mathbb{R}_+ \times \overline{\Omega})$</span>. If we assume that <span class="math inline">∀<em>y</em> ∈ ∂<em>Ω</em><sup>−</sup></span>,</p>
<p><br /><span class="math display">$$\begin{aligned}
    f_b^-(0,y) &amp;= f^{in}(y), \\
    \frac{\partial f_b^-}{\partial t}(0,y) + v \cdot \nabla_x f^{in}(y) + a(0,y)f^{in}(y)&amp;=S(0,y)
\end{aligned}$$</span><br /></p>
<p>In this case, the problem becomes:</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)+ a(t,x)f(t,x)=S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}$$</span><br /></p>
<p>has a unique solution <span class="math inline"><em>f</em> ∈ 𝒞<sup>1</sup>(ℝ<sub>+</sub> × <em>Ω</em>)</span> and <span class="math inline">$f \in \mathcal{C}^0(\mathbb{R}_+ \times \overline{\Omega})$</span>. The expression for <span class="math inline"><em>f</em></span> is then:</p>
<p><br /><span class="math display">$$\boxed{
    \begin{aligned}
        f(t,x) &amp;= \mathbf{1}_{t \leq \tau_x} f^{in} (x-tv) \exp\left(-\int_0^t a(s,x+(s-t)v)ds\right) \\
        &amp;\quad + \mathbf{1}_{t &gt; \tau_x} f_b^- (t-\tau_x,x-\tau_x v) \exp\left(-\int_{t-\tau_x}^t a(s,x+(s-t)v)ds\right) \\
        &amp;\quad + \int_{t-\tau_x}^t \exp\left(-\int_{s}^{t}a(\tau,x+(\tau-t)v)d\tau\right) S(s,x+(s-t)v)ds
\end{aligned}}$$</span><br /></p>
<h3 id="generalized-solutions">Generalized Solutions</h3>
<p>In this section, <span class="math inline"><em>Ω</em></span> is not necessarily convex. This implies that the continuity of potential solutions is not guaranteed. However, in practice, these cases must be addressed. Below, we define the concept of generalized solutions, which allows us to handle this issue without resorting to the theory of distributions.</p>
<h4 id="definition">Definition</h4>
<p>Let <span class="math inline"><em>Ω</em></span> be an open set with a <span class="math inline">𝒞<sup>1</sup></span> boundary in <span class="math inline">ℝ<sup><em>n</em></sup></span>, and let <span class="math inline"><em>a</em></span> and <span class="math inline"><em>S</em></span> be continuous on <span class="math inline">ℝ<sub>+</sub> × <em>Ω</em></span>. We say that <span class="math inline"><em>f</em></span> is a generalized solution of the problem</p>
<p><br /><span class="math display">$$\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)+ a(t,x)f(t,x)=S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\$$</span><br /></p>
<p>if and only if the function</p>
<p><span class="math inline"><em>s</em> ↦ <em>f</em>(<em>t</em> + <em>s</em>, <em>x</em> + <em>s</em><em>v</em>)</span> is of class <span class="math inline">𝒞<sup>1</sup></span> almost everywhere in <span class="math inline">(<em>t</em>, <em>x</em>) ∈ ℝ<sub>+</sub> × <em>Ω</em></span> and satisfies</p>
<p><span class="math inline">$\frac{d}{ds}f(t+s,x+sv) +a(t+s,x+sv)f(t+s,x+sv) = S(t+s,x+sv) \quad (t+s,x+sv) \in \mathbb{R}_+^* \times \Omega$</span>.</p>
<h4 id="section-5"></h4>
<p>Let <span class="math inline"><em>Ω</em></span> be an open set with a <span class="math inline">𝒞<sup>1</sup></span> boundary in <span class="math inline">ℝ<sup><em>n</em></sup></span>, and let <span class="math inline"><em>a</em></span> and <span class="math inline"><em>S</em></span> be continuous on <span class="math inline">ℝ<sub>+</sub> × <em>Ω</em></span>. Let <span class="math inline"><em>f</em><sub><em>b</em></sub><sup>−</sup> ∈ <strong>L</strong><sub><em>l</em><em>o</em><em>c</em></sub><sup>∞</sup>(ℝ<sub>+</sub> × ∂<em>Ω</em><sup>−</sup>)</span> and <span class="math inline">$f^{in} \in \mathbf{L}_{loc}^{\infty}(\overline{\Omega})$</span>.</p>
<p>In this case, the problem:</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)+ a(t,x)f(t,x)=S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}$$</span><br /></p>
<p>has a unique generalized solution. The formula for this solution is the same as in the previous case, i.e., almost everywhere in <span class="math inline">(<em>t</em>, <em>x</em>) ∈ ℝ<sub>+</sub> × <em>Ω</em></span>, we have:</p>
<p><br /><span class="math display">$$\boxed{
    \begin{aligned}
        f(t,x) &amp;= \mathbf{1}_{t \leq \tau_x} f^{in} (x-tv) \exp\left(-\int_0^t a(s,x+(s-t)v)ds\right) \\
        &amp;\quad + \mathbf{1}_{t &gt; \tau_x} f_b^- (t-\tau_x,x-\tau_x v) \exp\left(-\int_{t-\tau_x}^t a(s,x+(s-t)v)ds\right) \\
        &amp;\quad + \int_{t-\tau_x}^t \exp\left(-\int_{s}^{t}a(\tau,x+(\tau-t)v)d\tau\right) S(s,x+(s-t)v)ds
\end{aligned}}$$</span><br /></p>
<h2 id="linear-boltzmann-equation">Linear Boltzmann Equation</h2>
<p>In this section, we will focus on the actual Boltzmann equation. This integro-differential equation is described in <a href="#Boltzmann" data-reference-type="ref" data-reference="Boltzmann">[Boltzmann]</a>.</p>
<p><br /><span class="math display">$$\label{Boltzmann}
    \frac{\partial f}{\partial t}(t,x,v)+v \cdot \nabla_x f(t,x,v) + a(t,x)f(t,x,v) = \int_{\mathbb{R}^n}k(t,x,v,w)f(t,x,w)d\mu(w)+Q(t,x,v).$$</span><br /></p>
<p>To simplify notations, this equation will be written as: <br /><span class="math display">$$\frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q$$</span><br /></p>
<p>Here, <span class="math inline"><em>v</em></span> and <span class="math inline"><em>k</em></span> are given continuous functions. The range of possibilities for the velocity <span class="math inline"><em>v</em></span> is very diverse due to the variety of physical problems that can be considered. Therefore, the notation <span class="math inline"><em>d</em><em>μ</em>(<em>w</em>)</span> encompasses all these possibilities by incorporating a weight function. The major difference from the transport equation is that, this time, we consider exchange phenomena, and thus, <span class="math inline"><em>v</em></span> cannot be seen as a simple parameter.</p>
<p>In this section, we cannot highlight the exact expression of the solutions because the method of characteristics yields another integral equation involving the solution.</p>
<h4 id="definition-1">Definition</h4>
<p>Let <span class="math inline"><em>Q</em></span> be continuous on <span class="math inline">]0, <em>T</em>[ × <em>Ω</em> × ℝ<sup><em>n</em></sup></span>. We say that <span class="math inline"><em>f</em></span> is a generalized solution of the problem, continuous on <span class="math inline">]0, <em>T</em>[ × <em>Ω</em> × ℝ<sup><em>n</em></sup></span>,</p>
<p><br /><span class="math display">$$\frac{\partial f}{\partial t}+v \cdot \nabla_x f +af = \mathcal{K} f +Q\\$$</span><br /></p>
<h4 id="section-6"></h4>
<p>if and only if, for all <span class="math inline">(<em>t</em>, <em>x</em>, <em>v</em>) ∈ ]0, <em>T</em>[ × <em>Ω</em> × ℝ<sup><em>n</em></sup></span>, the function</p>
<p><br /><span class="math display"><em>s</em> ↦ <em>f</em>(<em>t</em> + <em>s</em>, <em>x</em> + <em>s</em><em>v</em>, <em>v</em>)</span><br /></p>
<p>is of class <span class="math inline">𝒞<sup>1</sup></span> for all <span class="math inline"><em>x</em> + <em>s</em><em>v</em> ∈ <em>Ω</em></span> and satisfies, for all <span class="math inline"><em>s</em> ∈ ℝ</span> such that <span class="math inline"><em>x</em> + <em>s</em><em>v</em> ∈ <em>Ω</em></span>,</p>
<p><span class="math inline">$\frac{d}{ds}f(t+s,x+sv,v) +a(t+s,x+sv,v)f(t+s,x+sv,v) = (\mathcal{K}f+ Q)(t+s,x+sv,v).$</span></p>
<h3 id="cauchy-problem-1">Cauchy Problem</h3>
<h4 id="section-7"></h4>
<p>Let <span class="math inline"><em>f</em><sup><em>i</em><em>n</em></sup> ∈ <strong>C</strong><sub><em>b</em></sub>(ℝ<sup><em>n</em></sup> × ℝ<sup><em>n</em></sup>)</span> and <span class="math inline"><em>Q</em> ∈ <strong>C</strong><sub><em>b</em></sub>(]0, <em>T</em>[ × ℝ<sup><em>n</em></sup> × ℝ<sup><em>n</em></sup>)</span>. Also, let <span class="math inline">0 ≤ <em>a</em> ∈ <strong>C</strong><sub><em>b</em></sub>(]0, <em>T</em>[ × ℝ<sub><em>x</em></sub><sup><em>n</em></sup> × ℝ<sub><em>v</em></sub><sup><em>n</em></sup>)</span> and <span class="math inline">0 ≤ <em>k</em> ∈ <strong>C</strong><sub><em>b</em></sub>(]0, <em>T</em>[ × ℝ<sub><em>x</em></sub><sup><em>n</em></sup> × ℝ<sub><em>v</em></sub><sup><em>n</em></sup> × ℝ<sub><em>w</em></sub><sup><em>n</em></sup>)</span>. The notation <span class="math inline"><strong>C</strong><sub><em>b</em></sub>(<em>X</em>)</span> denotes the set of bounded continuous functions on <span class="math inline"><em>X</em></span> with values in <span class="math inline">ℝ</span>.</p>
<p>We assume that: <br /><span class="math display">$$\underset{(t,x,v) \in ]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n}{\sup} \int_{\mathbb{R}^n} k(t,x,v,w) \, d\mu(w) &lt; +\infty$$</span><br /></p>
<h4 id="section-8"></h4>
<p>Then the problem is:</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q \quad (t,x,v) \in ]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}
\end{cases}$$</span><br /> has a unique generalized solution <span class="math inline"><em>f</em> ∈ <strong>C</strong><sub><em>b</em></sub>(]0, <em>T</em>[ × ℝ<sup><em>n</em></sup> × ℝ<sup><em>n</em></sup>)</span>.</p>
<h3 id="boundary-value-problem">Boundary Value Problem</h3>
<p>We define the set <span class="math inline"><em>Γ</em><sub>−</sub></span> as <span class="math inline"><em>Γ</em><sub>−</sub> = {(<em>x</em>, <em>v</em>) ∈ ∂<em>Ω</em> × ℝ<sup><em>n</em></sup> | <em>v</em> ⋅ <em>n</em><sub><em>x</em></sub> &lt; 0}</span></p>
<p>Let <span class="math inline">$f^{in} \in \mathbf{C}_b(\overline{\Omega} \times \mathbb{R}^n)$</span>, <span class="math inline"><em>f</em><sub><em>b</em></sub><sup>−</sup> ∈ <strong>C</strong><sub><em>b</em></sub>([0, <em>T</em>] × <em>Γ</em><sub>−</sub>)</span> such that <span class="math inline"><em>f</em><sub><em>b</em></sub><sup>−</sup>(0, <em>y</em>, <em>v</em>) = <em>f</em><sup><em>i</em><em>n</em></sup>(<em>y</em>, <em>v</em>) ∀(<em>y</em>, <em>v</em>) ∈ <em>Γ</em><sub>−</sub></span></p>
<p>Let <span class="math inline">$Q \in \mathbf{C}_b([0,T] \times \overline{\Omega} \times \mathbb{R}^n)$</span>.</p>
<p>Let <span class="math inline">0 ≤ <em>a</em> ∈ <strong>C</strong><sub><em>b</em></sub>(ℝ<sub>+</sub> × <em>Ω</em><sub><em>x</em></sub> × ℝ<sub><em>v</em></sub><sup><em>n</em></sup>)</span> and <span class="math inline">0 ≤ <em>k</em> ∈ <strong>C</strong><sub><em>b</em></sub>(ℝ<sub>+</sub> × <em>Ω</em><sub><em>x</em></sub><sup><em>n</em></sup> × ℝ<sub><em>v</em></sub><sup><em>n</em></sup> × ℝ<sub><em>w</em></sub><sup><em>n</em></sup>)</span>.</p>
<p>Then the problem</p>
<p><br /><span class="math display">$$\begin{cases}
    \frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q \quad (t,x,v) \in ]0,T[ \times \Omega \times \mathbb{R}^n\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}\\
    \mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}=f_b^-
\end{cases}$$</span><br /></p>
<p>has a unique generalized solution <span class="math inline"><em>f</em> ∈ <strong>C</strong><sub><em>b</em></sub>([0, <em>T</em>] × <em>Ω</em> × ℝ<sup><em>n</em></sup>)</span>.</p>
<h1 id="the-use-of-monte-carlo-methods-to-solve-the-linear-boltzmann-equation">The use of Monte Carlo methods to solve the linear Boltzmann equation</h1>
<p>To facilitate the introduction of a numerical Scheme let introduce new notation. The transport equation in an infinite medium with its corresponding deterministic collisional component can be expressed as: <br /><span class="math display">∂<sub><em>t</em></sub><em>u</em>(<em>x</em>, <em>t</em>, <strong>v</strong>) + <strong>v</strong> ⋅ ∇<em>u</em>(<em>x</em>, <em>t</em>, <strong>v</strong>) + <em>v</em><em>σ</em><sub><em>t</em></sub>(<em>x</em>, <em>t</em>, <strong>v</strong>)<em>u</em>(<em>x</em>, <em>t</em>, <strong>v</strong>) = <em>v</em><em>σ</em><sub><em>s</em></sub>(<em>x</em>, <em>t</em>, <strong>v</strong>)∫<em>P</em>(<em>x</em>, <em>t</em>, <strong>v</strong>, <strong>v</strong>′)<em>u</em>(<em>x</em>, <em>t</em>, <strong>v</strong>′)<em>d</em><strong>v</strong>′</span><br /></p>
<p>Where <br /><span class="math display">$$\sigma_s (x,t,\textbf{v})= \int \sigma_s (x,t,\textbf{v},\textbf{v}')d\textbf{v}', \quad  P (x,t,\textbf{v},\textbf{v}')=
    \frac{\sigma_s (x,t,\textbf{v},\textbf{v}')}{\sigma_s (x,t,\textbf{v})}$$</span><br /></p>
<p>The approach involves a series of variable changes. The initial step involves re-expressing the transport equation <a href="#ref11" data-reference-type="ref" data-reference="ref11">[ref11]</a> with respect to a characteristic <span class="math inline"><em>x</em> + <em>v</em><em>t</em></span>. As a result, it transforms into:</p>
<p><br /><span class="math display">∂<sub><em>s</em></sub><em>u</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>) =  − <em>v</em><em>σ</em><sub><em>t</em></sub>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>)<em>u</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>) + <em>v</em><em>σ</em><sub><em>s</em></sub>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>)∫<em>P</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>, <strong>v</strong>′)<em>u</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>′)<em>d</em><strong>v</strong>′</span><br /></p>
<p>Let’s multiply both sides of the equation by: <br /><span class="math display"><em>e</em><sup>∫<sub>0</sub><sup><em>s</em></sup><em>v</em><em>σ</em><sub><em>t</em></sub>(<em>x</em> + <strong>v</strong><em>α</em>, <em>α</em>, <em>v</em>)<em>d</em><em>α</em></sup></span><br /> Following that, we obtain <br /><span class="math display">∂<sub><em>s</em></sub>[<em>u</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>)<em>e</em><sup>∫<sub>0</sub><sup><em>s</em></sup><em>v</em><em>σ</em><sub><em>t</em></sub>(<em>x</em> + <strong>v</strong><em>α</em>, <em>α</em>, <em>v</em>)<em>d</em><em>α</em></sup>] = <em>e</em><sup>∫<sub>0</sub><sup><em>s</em></sup><em>v</em><em>σ</em><sub><em>t</em></sub>(<em>x</em> + <strong>v</strong><em>α</em>, <em>α</em>, <em>v</em>)<em>d</em><em>α</em></sup><em>v</em><em>σ</em><sub><em>s</em></sub>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>)∫<em>P</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>, <strong>v</strong>′)<em>u</em>(<em>x</em> + <strong>v</strong><em>s</em>, <em>s</em>, <strong>v</strong>′)<em>d</em><strong>v</strong>′</span><br /> We get after integrating the equation <a href="#ref12" data-reference-type="ref" data-reference="ref12">[ref12]</a> between [0, t]:</p>
<p><br /><span class="math display">$$\begin{gathered}
    u(x+\textbf{v}t,t,\textbf{v}) = u_0(x, \textbf{v}) \exp\left(- \int_{0}^{t} v\sigma_t\left(x + \textbf{v} \alpha, \alpha, \textbf{v}\right) d\alpha\right) \\
    + \int_{0}^{t} \int v\sigma_s\left(x + \textbf{v}s, s, \textbf{v}\right) u\left(x + \textbf{v}s, s, \textbf{v}'\right) e^{- \int_s^t v\sigma_t\left(x + \textbf{v} \alpha, \textbf{v}\right) d\alpha} P\left(x + \textbf{v} s, s, \textbf{v}, \textbf{v}'\right) d\textbf{v}'ds \end{gathered}$$</span><br /></p>
<p>We obtain:</p>
<p><br /><span class="math display">$$\begin{gathered}
    u(x,t,\textbf{v}) = u_0(x - \textbf{v}t, \textbf{v}) \exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v}(t - \alpha), \alpha, \textbf{v}\right) d\alpha\right) \\
    + \int_{0}^{t} \int v\sigma_s\left(x - \textbf{v}(t - s), s, \textbf{v}\right) u\left(x - \textbf{v}(t - s), s, \textbf{v}'\right) e^{- \int_s^t v\sigma_t\left(x - \textbf{v}(t - \alpha), \textbf{v}\right) d\alpha} P\left(x - \textbf{v}(t - s), s, \textbf{v}, \textbf{v}'\right) d\textbf{v}'ds \label{ref1}\end{gathered}$$</span><br /> We also have: <br /><span class="math display">$$\begin{gathered}
    \exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v}(t - \alpha), \alpha, \textbf{v}\right) d\alpha\right) = \exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) \\ = \int _t^\infty  v\sigma_t\left(x - \textbf{v} s,t- s, \textbf{v}\right)
    \exp\left(- \int_{0}^{s} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) ds\end{gathered}$$</span><br /> Then the integral representation of <a href="#ref11" data-reference-type="ref" data-reference="ref11">[ref11]</a> is provided by:</p>
<p><br /><span class="math display">$$\begin{gathered}
    u(x,t,\textbf{v}) =  \int _t^\infty  u_0(x - \textbf{v}t, \textbf{v}) v\sigma_t\left(x - \textbf{v} s,t- s, \textbf{v}\right)
    \exp\left(- \int_{0}^{s} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) ds\\
    + \int_{0}^{t} \int v\sigma_s\left(x - \textbf{v}(t - s), s, \textbf{v}\right) u\left(x - \textbf{v}(t - s), s, \textbf{v}'\right) e^{- \int_s^t v\sigma_t\left(x - \textbf{v}(t - \alpha), \textbf{v}\right) d\alpha} P\left(x - \textbf{v}(t - s), s, \textbf{v}, \textbf{v}'\right) d\textbf{v}'ds \label{ref13}\end{gathered}$$</span><br /></p>
<h1 id="semi-analog-mc-scheme">Semi analog MC scheme</h1>
<p>Developing a Monte Carlo scheme involves introducing a group of random variables along with their associated probability measure to express <a href="#ref13" data-reference-type="ref" data-reference="ref13">[ref13]</a> as an expectation. The selection of this set of random variables is not unique, resulting in various Monte Carlo schemes with distinct properties. In this project we used one of them, the so-called Semi-analog scheme. The algorithm 1 describe this method.</p>
<h4 id="section-9"></h4>
<p>This method is described as backward. In fact, we first initialize <span class="math inline"><em>S</em><sub><em>p</em></sub></span>, the remaining lifetime of the particle, to <span class="math inline"><em>t</em></span>, and it will decrease to zero. Here, we adopt a general form for the boundary conditions. In the program we developed, we have tried various conditions: Periodic boundary conditions (which are not truly significant in a physical problem but can be interpreted as an infinite environment), and Elastic boundary conditions.</p>
<p>At line 11, we sample <span class="math inline"><em>τ</em></span> using the function: <span class="math inline">$\tau = \frac{-\ln(\mathcal{U}(0,1))}{\sigma_t \sqrt{v^2}}$</span>. If <span class="math inline"><em>τ</em></span> is greater than <span class="math inline"><em>s</em><sub><em>p</em></sub></span>, then the particle is moved, its lifetime is set to zero, and its contribution is updated. Otherwise, the particle is moved, its speed is sampled, its lifetime is updated, and then its weight is changed.</p>
<p><span class="math inline"><em>u</em>(<em>x</em>, <em>t</em>, <em>v</em>) ← 0</span> <span class="math inline"><em>s</em><sub><em>p</em></sub> ← <em>t</em></span> <span class="math inline"><em>x</em><sub><em>p</em></sub> ← <em>x</em></span> <span class="math inline"><em>v</em><sub><em>p</em></sub> ← <em>v</em></span> <span class="math inline">$w_p \gets \frac{1}{N_{MC}}$</span> apply_boundary_conditions<span class="math inline">(<em>x</em><sub><em>p</em></sub>, <em>s</em><sub><em>p</em></sub>, <em>v</em><sub><em>p</em></sub>)</span> Sample <span class="math inline"><em>τ</em></span>.</p>
<p><span class="math inline"><em>x</em><sub><em>p</em></sub> ←  − <em>v</em><sub><em>p</em></sub><em>s</em><sub><em>p</em></sub></span></p>
<p><span class="math inline"><em>s</em><sub><em>p</em></sub> ← 0</span></p>
<p><span class="math inline"><em>u</em>(<em>x</em>, <em>t</em>, <em>v</em>) ← <em>w</em><sub><em>p</em></sub> × <em>u</em><sub>0</sub>(<em>x</em><sub><em>p</em></sub>, <em>v</em><sub><em>p</em></sub>)</span></p>
<p><span class="math inline"><em>x</em><sub><em>p</em></sub> ←  − <em>v</em><sub><em>p</em></sub><em>τ</em></span> Sample the velocity of particle p from <span class="math inline"><em>P</em>(<em>x</em><sub><em>p</em></sub>, <em>s</em><sub><em>p</em></sub>, <em>v</em><sub><em>p</em></sub>, <em>d</em><em>v</em>′)</span> <span class="math inline"><em>v</em><sub><em>p</em></sub> ← <em>v</em>′</span></p>
<p><span class="math inline"><em>s</em><sub><em>p</em></sub> ←  − <em>τ</em></span></p>
<p><span class="math inline">$w_p \gets \frac{\sigma(x_p, s_p, v')}{\sigma(x_p, s_p, v_p)} \times w_p$</span></p>
<h1 id="numerical-testsresults">Numerical tests/results</h1>
<p>à voir</p>
<p>strucutre code mise en place bnr differents test dispo cf les prties récédentes</p>
<p>resultats</p>
<h1 id="conclusion">Conclusion</h1>
</body>
</html>
