<p><span class="smallcaps">ENSEIRB-MATMECA</span><br />
</p>
<p><img src="logo ecole.jpg" alt="image" /></p>
<hr />
<p><br />
<span><strong>Solving the linear Boltzmann equation using Monte Carlo methods</strong> </span><br />
</p>
<hr />
<p><br />
<span><strong></strong></span></p>
<p><span>Project lead by :</span><br />
<span>C. Aumonier, A. Boucher, G. Doyen, K. El Maddah, G. Rodiere</span></p>
<p><span>Project supervised by :</span><br />
<span>G. Poëtte</span></p>
<p><span>January 2024</span></p>
<h1 id="introduction">Introduction</h1>
<h2 id="terms-and-definitions">Terms and definitions</h2>
<p>The transport equation plays a crucial role in describing the behavior of particles in various physical systems. One of its important derivatives, the linear Boltzmann equation, is governed by the evolution of particle distribution in phase space. In this project, a numerical solution for the linear Boltzmann equation is developed utilizing the Monte Carlo method. The report is structured as follows:</p>
<ul>
<li><p><strong>Transport Equation:</strong> The fundamental transport equation is introduced, providing a basis for understanding the derivation of the linear Boltzmann equation.</p></li>
<li><p><strong>Linear Boltzmann Equation:</strong> Building upon the transport equation, the linear Boltzmann equation is explored, emphasizing its significance in characterizing particle transport phenomena.</p></li>
<li><p><strong>Monte Carlo Method for Linear Boltzmann Equation:</strong> The approach to solving the linear Boltzmann equation using the Monte Carlo method is presented, along with a discussion of the advantages and challenges associated with this numerical technique.</p></li>
<li><p><strong>Semi-Analog Monte Carlo Scheme:</strong> A semi-analog Monte Carlo scheme is introduced as an innovative strategy to enhance the efficiency and accuracy of simulations.</p></li>
</ul>
<h2 id="context-and-applications">Context and Applications</h2>
<h4 id="section"></h4>
<p>The linear Boltzmann equation finds applications in a wide range of industrial and research contexts. Notable examples include its use in nuclear reactor physics, radiation shielding design, medical imaging, and astrophysics. Applications extend to industries such as nuclear energy, healthcare, and aerospace, where accurate simulations of particle transport are crucial for optimizing designs and ensuring safety protocols.</p>
<p>In the realm of academic research, the linear Boltzmann equation serves as a cornerstone in the study of rarefied gas dynamics, plasma physics, and neutron transport. Collaborations between universities, research institutions, and companies contribute to advancements in understanding and solving complex problems associated with particle transport phenomena.</p>
<p>This project aims to contribute to the broader understanding and application of the linear Boltzmann equation, with a focus on developing efficient numerical methods for solving this intricate problem.</p>
<h1 id="mathematical-analysis">Mathematical analysis</h1>
<h4 id="section-1"></h4>
<p>Here is a brief summary of the various existences and uniqueness of solutions based on different cases of equations to be solved. The primary source used is the transport and diffusion document.</p>
<h2 id="transport-equation">Transport Equation</h2>
<h4 id="section-2"></h4>
<p>In this section, the solutions of the transport equation, a particular case of the Boltzmann equation defined below, will be examined.</p>
<p><span class="math display">\[\label{transport}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x) + a(t,x)f(t,x) = S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\]</span></p>
<p>where <span class="math inline">\(f\)</span> is the unknown function, <span class="math inline">\(a\)</span> is the given damping or amplification rate, and <span class="math inline">\(S\)</span> is the given source term.</p>
<h3 id="cauchy-problem">Cauchy Problem</h3>
<h4 id="section-3"></h4>
<p>Let the following Cauchy problem without absorption or source term be considered :</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)=0, \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
f(0,x)) = f^{in}(x)
\end{cases}\]</span></p>
<p>where <span class="math inline">\(f^{in}(x)\)</span> is the seeked initial value of <span class="math inline">\(f\)</span>’s density. If <span class="math inline">\(f^{in} \in \mathcal{C}^1(\mathbb{R}^n)\)</span>, then using the method of characteristics, the uniqueness of the solution <span class="math inline">\(f \in \mathcal{C}^1(\mathbb{R}_+ \times \mathbb{R}^n)\)</span> for the Cauchy problem can easily be demonstrated. This solution is given as follows :</p>
<p><span class="math display">\[f(t,x)=f^{in}(x-tv) \quad \forall (t,x) \in \mathbb{R}_+ \times \mathbb{R}^n\]</span></p>
<h4 id="section-4"></h4>
<p>This time, a damping and a source term are considered, assuming they belong to <span class="math inline">\(\mathcal{C}^1(\mathbb{R}_+ \times \mathbb{R}^n)\)</span>. The considered Cauchy problem is given as follows:</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x) + a(t,x)f(t,x) = S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
f(0,x)) = f^{in}(x)
\end{cases}\]</span></p>
<p>Here the uniqueness of the solution remains unchanged so by the same method, the solution is given by :</p>
<p><span class="math display">\[f(t,x)=f^{in}(x-tv) e^{-\int_0 ^t a(\tau,x+(t-\tau)v)d\tau} + \int_0 ^t  e^{-\int_0 ^t a(\tau,x+(t-\tau)v)d\tau} S(s,x+(s-t)v)ds \quad \forall (t,x) \in \mathbb{R}_+ \times \mathbb{R}^n\]</span></p>
<p>Next, a partial demonstration of the previous formula is suggested, using the method of characteristics. For more details, the reader is refered to <span class="citation" data-cites="allaire:2019"></span>.</p>
<p>Let <span class="math inline">\(y \in \mathbb{R}\)</span>, and consider the characteristic curve emanating from <span class="math inline">\(y\)</span> at <span class="math inline">\(t=0\)</span>, given by :</p>
<p><span class="math display">\[\{(t,\gamma(t)),  t\geq 0\} , \text{ where } \gamma (t)=y+tv\]</span></p>
<p>If <span class="math inline">\(f \in \mathcal{C}^1(\mathbb{R}_+ \times \mathbb{R}^n\)</span> is the solution of the previous Cauchy problem, then <span class="math inline">\(t \mapsto f(t,\gamma(t))\)</span> is of <span class="math inline">\(\mathcal{C}^1\)</span> class on <span class="math inline">\(\mathbb{R}_+\)</span>, and</p>
<p><span class="math display">\[\begin{aligned}
\frac{d f}{d t}(t,\gamma(t))&amp;=(\frac{\partial f}{\partial t}
v \cdot \nabla_x f(t,x))(t,\gamma(t)) \\ &amp;= S(t,\gamma(t))-a(t,\gamma(t))f(t,\gamma(t)), \quad t&gt;0.
\end{aligned}\]</span></p>
<p>The previous partial differential equation is now reduced to an ordinary differential equation (ODE) of the form:</p>
<p><span class="math display">\[\begin{cases}
u&#39;(t)+\alpha(t)u(t)=\Sigma(t), \quad t&gt;0,\\
u(0)=u^{in}
\end{cases}\]</span></p>
<p>The well-known solution is calculated using the constant variation method:</p>
<p><span class="math display">\[u(t) = u^{in} e^{-A(t)} + \int_{0}^{t} e^{-A(t)-A(s)}\Sigma(s)ds, \text{ with } A(t)=\int_{0}^{t} \alpha (\tau) d\tau.\]</span></p>
<p>The following expression is then obteined by applying this to the Cauchy problem along the characteristic curve from <span class="math inline">\(y\)</span> at <span class="math inline">\(t=0\)</span> :</p>
<p><span class="math display">\[f(t,y+tv) = f^{in}(y) e^{\int_{0}^{t}a(\tau,y+\tau v)d\tau} + \int_{0}^{t} e^{\int_{0}^{t}a(\tau,y+\tau v)d\tau}S(s,y+sv)ds, \quad y\in \mathbb{R}^n, t \geq 0.\]</span></p>
<p>Finally, the expected expression is deduced replacing the dummy variable <span class="math inline">\(y\)</span> with <span class="math inline">\(x-tv\)</span>.</p>
<h3 id="boundary-value-problems">Boundary Value Problems</h3>
<h4 id="section-5"></h4>
<p>In the preceding section, outcomes relevant to the exploration of unrestricted spatial variables in <span class="math inline">\(\mathbb{R}^n\)</span> were provided. However, for the majority of physical problems, this spatial unrestriction has no sens. That is why a problem of the boundary value type is more interesting. In this section, the set <span class="math inline">\(\Omega\)</span>, which is an open set with a <span class="math inline">\(\mathcal{C}^1\)</span> boundary in <span class="math inline">\(\mathbb{R}^n\)</span> is considered. Additionally, <span class="math inline">\(v \in \mathbb{R}^n\backslash \{0\}\)</span> is considered.</p>
<h4 id="special-case-without-absorption-or-source-term">Special Case without Absorption or Source Term</h4>
<h4 id="section-6"></h4>
<p>Let <span class="math inline">\(\Omega\)</span> be convex, <span class="math inline">\(f_b^- \in \mathcal{C}^1(\mathbb{R}_+ \times \partial \Omega^-)\)</span> and <span class="math inline">\(f^{in} \in \mathcal{C}^1(\overline{\Omega})\)</span>, where <span class="math inline">\(\partial \Omega^- = \{x\in\partial \Omega~ | ~ v\cdot n_x&lt;0\}\)</span>, then the problem:</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)=0, \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}\]</span></p>
<p>has a unique solution <span class="math inline">\(f \in \mathcal{C}^1(\mathbb{R}_+ \times \Omega)\)</span> and <span class="math inline">\(f \in \mathcal{C}^0(\mathbb{R}_+ \times \overline{\Omega})\)</span> if and only if <span class="math inline">\(\forall y \in \partial \Omega^-,\)</span></p>
<p><span class="math display">\[f_b^-(0,y) = f^{in}(y), \quad \frac{\partial f_b^-}{\partial t}(t,y)+v \cdot \nabla f^{in}(y)=0.\]</span></p>
<h4 id="section-7"></h4>
<p>The expression of the solution is then given by:</p>
<p><span class="math display">\[f(t,x)= 
\begin{cases}
f^{in}(x-tv) \quad si~ t \leq \tau_x ,\\
f_b^-(t-\tau_x,x-\tau_xv) \quad si~ t &gt; \tau_x ,
\end{cases}\]</span></p>
<p>with <span class="math inline">\(\tau_x= \inf \{t \geq 0~ | ~ x-tv \notin \overline{\Omega}\}\)</span></p>
<h4 id="with-absorption-and-source-term">With Absorption and Source Term</h4>
<h4 id="section-8"></h4>
<p>Let still <span class="math inline">\(\Omega\)</span> be convex, with <span class="math inline">\(f_b^- \in \mathcal{C}^1(\mathbb{R}_+ \times \partial \Omega^-)\)</span>, <span class="math inline">\(f^{in} \in \mathcal{C}^1(\overline{\Omega})\)</span>, <span class="math inline">\(a\)</span>, and <span class="math inline">\(S\)</span> <span class="math inline">\(\in \mathcal{C}^1(\mathbb{R}_+ \times \overline{\Omega})\)</span>. <span class="math inline">\(\forall y \in \partial \Omega^-\)</span> :</p>
<p><span class="math display">\[\begin{aligned}
f_b^-(0,y) &amp;= f^{in}(y), \\
S(0,y) &amp;= \frac{\partial f_b^-}{\partial t}(0,y) + v \cdot \nabla_x f^{in}(y) + a(0,y)f^{in}(y)
\end{aligned}\]</span></p>
<p>In this case, the problem becomes :</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)+ a(t,x)f(t,x)=S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}\]</span></p>
<p>and has a unique solution <span class="math inline">\(f \in \mathcal{C}^1(\mathbb{R}_+ \times \Omega)\)</span> and <span class="math inline">\(f \in \mathcal{C}^0(\mathbb{R}_+ \times \overline{\Omega})\)</span>. The expression for <span class="math inline">\(f\)</span> is then:</p>
<p><span class="math display">\[\boxed{
    \begin{aligned}
    f(t,x) &amp;= \mathbf{1}_{t \leq \tau_x} f^{in} (x-tv) \exp\left(-\int_0^t a(s,x+(s-t)v)ds\right) \\
    &amp;\quad + \mathbf{1}_{t &gt; \tau_x} f_b^- (t-\tau_x,x-\tau_x v) \exp\left(-\int_{t-\tau_x}^t a(s,x+(s-t)v)ds\right) \\
    &amp;\quad + \int_{t-\tau_x}^t \exp\left(-\int_{s}^{t}a(\tau,x+(\tau-t)v)d\tau\right) S(s,x+(s-t)v)ds
    \end{aligned}}\]</span></p>
<h3 id="generalized-solutions">Generalized Solutions</h3>
<h4 id="section-9"></h4>
<p>In this section, <span class="math inline">\(\Omega\)</span> is not necessarily convex. This implies that the continuity of potential solutions is not guaranteed. However, in practice, these cases must be addressed. Below, the concept of generalized solutions is defined, which allows to handle this issue without resorting to the theory of distributions.</p>
<h4 id="definition">Definition</h4>
<p>Let <span class="math inline">\(\Omega\)</span> be an open set with a <span class="math inline">\(\mathcal{C}^1\)</span> boundary in <span class="math inline">\(\mathbb{R}^n\)</span>, and let <span class="math inline">\(a\)</span> and <span class="math inline">\(S\)</span> be continuous on <span class="math inline">\(\mathbb{R}_+ \times \Omega\)</span>. <span class="math inline">\(f\)</span> is a generalized solution of the problem <span class="math inline">\((1)\)</span> if and only if the function <span class="math inline">\(s \mapsto f(t+s,x+sv)\)</span> is of class <span class="math inline">\(\mathcal{C}^1\)</span> almost everywhere in <span class="math inline">\((t,x) \in \mathbb{R}_+ \times \Omega\)</span> and satisfies :</p>
<p><span class="math display">\[\frac{d}{ds}f(t+s,x+sv) +a(t+s,x+sv)f(t+s,x+sv) = S(t+s,x+sv) \quad (t+s,x+sv) \in \mathbb{R}_+^* \times \Omega.\]</span></p>
<h4 id="section-10"></h4>
<p>Now let <span class="math inline">\(\Omega\)</span> be an open set with a <span class="math inline">\(\mathcal{C}^1\)</span> boundary in <span class="math inline">\(\mathbb{R}^n\)</span>, and let <span class="math inline">\(a\)</span> and <span class="math inline">\(S\)</span> be continuous on <span class="math inline">\(\mathbb{R}_+ \times \Omega\)</span>. Let <span class="math inline">\(f_b^- \in \mathbf{L}_{loc}^{\infty}(\mathbb{R}_+ \times \partial \Omega^-)\)</span> and <span class="math inline">\(f^{in} \in \mathbf{L}_{loc}^{\infty}(\overline{\Omega})\)</span>. In this case, the problem:</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}(t,x)+v \cdot \nabla_x f(t,x)+ a(t,x)f(t,x)=S(t,x), \quad x \in \mathbb{R}^N, \quad t&gt;0.\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \partial \Omega}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\partial \Omega}}= f_b^-\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}(x)
\end{cases}\]</span></p>
<p>has a unique generalized solution. The formula for this solution is the same as in the previous case, i.e., almost everywhere in <span class="math inline">\((t,x) \in \mathbb{R}_+ \times \Omega\)</span> :</p>
<p><span class="math display">\[\boxed{
    \begin{aligned}
    f(t,x) &amp;= \mathbf{1}_{t \leq \tau_x} f^{in} (x-tv) \exp\left(-\int_0^t a(s,x+(s-t)v)ds\right) \\
    &amp;\quad + \mathbf{1}_{t &gt; \tau_x} f_b^- (t-\tau_x,x-\tau_x v) \exp\left(-\int_{t-\tau_x}^t a(s,x+(s-t)v)ds\right) \\
    &amp;\quad + \int_{t-\tau_x}^t \exp\left(-\int_{s}^{t}a(\tau,x+(\tau-t)v)d\tau\right) S(s,x+(s-t)v)ds
    \end{aligned}}\]</span></p>
<h2 id="linear-boltzmann-equation">Linear Boltzmann Equation</h2>
<p>In this section, a particular attention is paid on the actual Boltzmann equation. This integro-differential equation is described hereafter.</p>
<p><span class="math display">\[\label{Boltzmann}
\frac{\partial f}{\partial t}(t,x,v)+v \cdot \nabla_x f(t,x,v) + a(t,x)f(t,x,v) = \int_{\mathbb{R}^n}k(t,x,v,w)f(t,x,w)d\mu(w)+Q(t,x,v).\]</span></p>
<p>To simplify notations, this equation will be written as: <span class="math display">\[\frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q\]</span></p>
<p>Here, <span class="math inline">\(v\)</span> and <span class="math inline">\(k\)</span> are given continuous functions. The range of possibilities for the velocity <span class="math inline">\(v\)</span> is very diverse due to the variety of physical problems that can be considered. Therefore, the notation <span class="math inline">\(d\mu(w)\)</span> encompasses all these possibilities by incorporating a weight function. The major difference from the transport equation is that, this time, exchange phenomena are considered, and thus, <span class="math inline">\(v\)</span> can not be seen as a simple parameter.</p>
<p>In this section, the exact expression of the solutions can not be highlighted because the method of characteristics yields another integral equation involving the solution.</p>
<h4 id="definition-1">Definition</h4>
<p>Let <span class="math inline">\(Q\)</span> be continuous on <span class="math inline">\(]0,T[\times \Omega \times \mathbb{R}^n\)</span>. <span class="math inline">\(f\)</span> is a generalized solution of the problem <span class="citation" data-cites="Boltzmann"></span> if and only if, <span class="math inline">\(\forall (t,x,v) \in ]0,T[\times \Omega \times \mathbb{R}^n\)</span>, the function <span class="math inline">\(s \mapsto f(t+s,x+sv,v)\)</span> is of class <span class="math inline">\(\mathcal{C}^1\)</span> for all <span class="math inline">\(x+sv \in \Omega\)</span> and satisfies : <span class="math display">\[\frac{d}{ds}f(t+s,x+sv,v) +a(t+s,x+sv,v)f(t+s,x+sv,v) = (\mathcal{K}f+ Q)(t+s,x+sv,v).\]</span></p>
<p><span class="math inline">\(\forall s \in \mathbb{R}\)</span> such that <span class="math inline">\(x +sv \in \Omega\)</span>.</p>
<h3 id="cauchy-problem-1">Cauchy Problem</h3>
<h4 id="section-11"></h4>
<p>Let <span class="math inline">\(f^{in} \in \mathbf{C}_b(\mathbb{R}^n \times \mathbb{R}^n)\)</span> and <span class="math inline">\(Q \in \mathbf{C}_b(]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n)\)</span>. Also, let <span class="math inline">\(0 \leq a \in \mathbf{C}_b(]0,T[ \times \mathbb{R}_x^n \times \mathbb{R}_v^n)\)</span> and <span class="math inline">\(0 \leq k \in \mathbf{C}_b(]0,T[ \times \mathbb{R}_x^n \times \mathbb{R}_v^n \times \mathbb{R}_w^n)\)</span>. The notation <span class="math inline">\(\mathbf{C}_b(X)\)</span> denotes the set of bounded continuous functions on <span class="math inline">\(X\)</span> with values in <span class="math inline">\(\mathbb{R}\)</span>. Now assume that :</p>
<p><span class="math display">\[\underset{(t,x,v) \in ]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n}{\sup} \int_{\mathbb{R}^n} k(t,x,v,w) \, d\mu(w) &lt; +\infty\]</span></p>
<p>Then the problem :</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q \quad (t,x,v) \in ]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}
\end{cases}\]</span></p>
<p>has a unique generalized solution <span class="math inline">\(f \in \mathbf{C}_b(]0,T[ \times \mathbb{R}^n \times \mathbb{R}^n)\)</span>.</p>
<h3 id="boundary-value-problem">Boundary Value Problem</h3>
<h4 id="section-12"></h4>
<p>The set <span class="math inline">\(\Gamma_-\)</span> is defined as <span class="math inline">\(\Gamma_-= \{(x,v) \in \partial \Omega \times \mathbb{R}^n ~ | ~ v\cdot n_x&lt;0\}\)</span>. Let :</p>
<ul>
<li><p><span class="math inline">\(f^{in} \in \mathbf{C}_b(\overline{\Omega} \times \mathbb{R}^n)\)</span>, <span class="math inline">\(f_b^- \in \mathbf{C}_b([0,T] \times \Gamma_-)\)</span> such that <span class="math inline">\(f_b^-(0,y,v)=f^{in}(y,v) \quad \forall (y,v) \in \Gamma_-\)</span></p></li>
<li><p><span class="math inline">\(Q \in \mathbf{C}_b([0,T] \times \overline{\Omega} \times \mathbb{R}^n)\)</span></p></li>
<li><p><span class="math inline">\(0 \leq a \in \mathbf{C}_b(\mathbb{R}_+ \times \Omega_x \times \mathbb{R}_v^n)\)</span> and <span class="math inline">\(0 \leq k \in \mathbf{C}_b(\mathbb{R}_+ \times \Omega_x^n \times \mathbb{R}_v^n \times \mathbb{R}_w^n)\)</span></p></li>
</ul>
<p>Then the problem</p>
<p><span class="math display">\[\begin{cases}
\frac{\partial f}{\partial t}+v \cdot \nabla_x f +af =   \mathcal{K} f +Q \quad (t,x,v) \in ]0,T[ \times \Omega \times \mathbb{R}^n\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle t=0}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,t=0}}= f^{in}\\
\mathchoice{\setbox 1\hbox{${\displaystyle f}_{\scriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\textstyle f}_{\scriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\scriptstyle f}_{\scriptscriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}{\setbox 1\hbox{${\scriptscriptstyle f}_{\scriptscriptstyle \Gamma^-}$}
        {f\,\smash{\vrule height .8\ht 1 depth .85\dp 1}}_{\,\Gamma^-}}=f_b^-
\end{cases}\]</span></p>
<p>has a unique generalized solution <span class="math inline">\(f \in \mathbf{C}_b([0,T] \times \Omega \times \mathbb{R}^n)\)</span>.</p>
<h1 id="the-use-of-monte-carlo-methods-to-solve-the-linear-boltzmann-equation">The use of Monte Carlo methods to solve the linear Boltzmann equation</h1>
<h4 id="section-13"></h4>
<p>To facilitate the introduction of a numerical scheme, the equation is modified into an integral form. The different steps are detailed in this section.</p>
<p>The transport equation in an infinite medium with its corresponding deterministic collisional component<span class="citation" data-cites="lapeyre_methodes_1998"></span> can be expressed as : <span class="math display">\[\partial _t u(x,t,\textbf{v}) + \textbf{v} \cdot \nabla u(x,t,\textbf{v}) + v\sigma_t (x,t,\textbf{v})u(x,t,\textbf{v})= v\sigma_s(x,t,\textbf{v})\int P (x,t,\textbf{v},\textbf{v}&#39;)u(x,t,\textbf{v}&#39;)d\textbf{v}&#39; \label{ref11}\]</span></p>
<p>Where <span class="math display">\[\sigma_s (x,t,\textbf{v})= \int \sigma_s (x,t,\textbf{v},\textbf{v}&#39;)d\textbf{v}&#39;, \quad  P (x,t,\textbf{v},\textbf{v}&#39;)=
\frac{\sigma_s (x,t,\textbf{v},\textbf{v}&#39;)}{\sigma_s (x,t,\textbf{v})}\]</span></p>
<p>This approach involves a series of variable changes. The initial step involves re-expressing the transport equation <a href="#ref11" data-reference-type="ref" data-reference="ref11">[ref11]</a> with respect to a characteristic <span class="math inline">\(x + vt\)</span>. As a result, it transforms into :</p>
<p><span class="math display">\[\partial _s u(x+\textbf{v}s,s,\textbf{v}) = -v\sigma_t (x+\textbf{v}s,s,\textbf{v})u(x+\textbf{v}s,s,\textbf{v}) + v\sigma_s(x+\textbf{v}s,s,\textbf{v})\int P (x+\textbf{v}s,s,\textbf{v},\textbf{v}&#39;)u(x+\textbf{v}s,s,\textbf{v}&#39;)d\textbf{v}&#39;\]</span> By multiplying both sides of the equation by <span class="math inline">\(e^{\int _0^s v\sigma_t (x + \textbf{v}\alpha,\alpha, v) d\alpha}\)</span>, the equation becomes : <span class="math display">\[\partial _s [u(x+\textbf{v}s,s,\textbf{v})e^{\int _0^s v\sigma_t (x + \textbf{v}\alpha,\alpha, v) d\alpha}] = e^{\int _0^s v\sigma_t (x + \textbf{v}\alpha,\alpha, v) d\alpha} v\sigma_s(x+\textbf{v}s,s,\textbf{v})\int P (x+\textbf{v}s,s,\textbf{v},\textbf{v}&#39;)u(x+\textbf{v}s,s,\textbf{v}&#39;)d\textbf{v}&#39; \label{ref12}\]</span> After an integration on <span class="math inline">\([0, t]\)</span>, the equation now yields : <span class="math display">\[\begin{gathered}
u(x+\textbf{v}t,t,\textbf{v}) = u_0(x, \textbf{v}) \exp\left(- \int_{0}^{t} v\sigma_t\left(x + \textbf{v} \alpha, \alpha, \textbf{v}\right) d\alpha\right) \\
+ \int_{0}^{t} \int v\sigma_s\left(x + \textbf{v}s, s, \textbf{v}\right) u\left(x + \textbf{v}s, s, \textbf{v}&#39;\right) e^{- \int_s^t v\sigma_t\left(x + \textbf{v} \alpha, \textbf{v}\right) d\alpha} P\left(x + \textbf{v} s, s, \textbf{v}, \textbf{v}&#39;\right) d\textbf{v}&#39;ds \end{gathered}\]</span> And then :</p>
<p><span class="math display">\[\begin{gathered}
u(x,t,\textbf{v}) = u_0(x - \textbf{v}t, \textbf{v}) \exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v}(t - \alpha), \alpha, \textbf{v}\right) d\alpha\right) \\
+ \int_{0}^{t} \int v\sigma_s\left(x - \textbf{v}(t - s), s, \textbf{v}\right) u\left(x - \textbf{v}(t - s), s, \textbf{v}&#39;\right) e^{- \int_s^t v\sigma_t\left(x - \textbf{v}(t - \alpha), \textbf{v}\right) d\alpha} P\left(x - \textbf{v}(t - s), s, \textbf{v}, \textbf{v}&#39;\right) d\textbf{v}&#39;ds \label{ref1}\end{gathered}\]</span> But also : <span class="math display">\[\begin{gathered}
\exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v}(t - \alpha), \alpha, \textbf{v}\right) d\alpha\right) = \exp\left(- \int_{0}^{t} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) \\ = \int _t^\infty  v\sigma_t\left(x - \textbf{v} s,t- s, \textbf{v}\right)
\exp\left(- \int_{0}^{s} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) ds\end{gathered}\]</span> Then the integral representation of <a href="#ref11" data-reference-type="ref" data-reference="ref11">[ref11]</a> is provided by:</p>
<p><span class="math display">\[\begin{gathered}
u(x,t,\textbf{v}) =  \int _t^\infty  u_0(x - \textbf{v}t, \textbf{v}) v\sigma_t\left(x - \textbf{v} s,t- s, \textbf{v}\right)
\exp\left(- \int_{0}^{s} v\sigma_t\left(x - \textbf{v} \alpha,t- \alpha, \textbf{v}\right) d\alpha\right) ds\\
+ \int_{0}^{t} \int v\sigma_s\left(x - \textbf{v}(t - s), s, \textbf{v}\right) u\left(x - \textbf{v}(t - s), s, \textbf{v}&#39;\right) e^{- \int_s^t v\sigma_t\left(x - \textbf{v}(t - \alpha), \textbf{v}\right) d\alpha} P\left(x - \textbf{v}(t - s), s, \textbf{v}, \textbf{v}&#39;\right) d\textbf{v}&#39;ds \label{ref13}\end{gathered}\]</span></p>
<h1 id="semi-analog-mc-scheme">Semi analog MC scheme</h1>
<p>Developing a Monte Carlo scheme involves introducing a group of random variables along with their associated probability measure to express <a href="#ref13" data-reference-type="ref" data-reference="ref13">[ref13]</a> as an expectation. The selection of this set of random variables is not unique, resulting in various Monte Carlo schemes with distinct properties. In this project we used one of them, the so-called Semi-analog scheme. The algorithm 1 describe this method.</p>
<h4 id="section-14"></h4>
<p>This method is described as backward. In fact, we first initialize <span class="math inline">\(S_p\)</span>, the remaining lifetime of the particle, to <span class="math inline">\(t\)</span>, and it will decrease to zero. Here, we adopt a general form for the boundary conditions. In the program we developed, we have tried various conditions: Periodic boundary conditions (which are not truly significant in a physical problem but can be interpreted as an infinite environment), and Elastic boundary conditions.</p>
<p>At line 11, we sample <span class="math inline">\(\tau\)</span> using the function: <span class="math inline">\(\tau = \frac{-\ln(\mathcal{U}(0,1))}{\sigma_t \sqrt{v^2}}\)</span>. If <span class="math inline">\(\tau\)</span> is greater than <span class="math inline">\(s_p\)</span>, then the particle is moved, its lifetime is set to zero, and its contribution is updated. Otherwise, the particle is moved, its speed is sampled on the unit sphere, its lifetime is updated, and then its weight is changed.</p>
<p><span class="math inline">\(u(x, t, v) \gets 0\)</span> <span class="math inline">\(s_p \gets t\)</span> <span class="math inline">\(x_p \gets x\)</span> <span class="math inline">\(v_p \gets v\)</span> <span class="math inline">\(w_p \gets \frac{1}{N_{MC}}\)</span> apply_boundary_conditions<span class="math inline">\((x_p, s_p, v_p)\)</span> Sample <span class="math inline">\(\tau\)</span>.</p>
<p><span class="math inline">\(x_p \gets - v_p s_p\)</span></p>
<p><span class="math inline">\(s_p \gets 0\)</span></p>
<p><span class="math inline">\(u(x, t, v) \gets w_p \times u_0(x_p, v_p)\)</span></p>
<p><span class="math inline">\(x_p \gets - v_p \tau\)</span> Sample the velocity of particle p from <span class="math inline">\(P(x_p, s_p, v_p, dv&#39;)\)</span> <span class="math inline">\(v_p \gets v&#39;\)</span></p>
<p><span class="math inline">\(s_p \gets - \tau\)</span></p>
<p><span class="math inline">\(w_p \gets \frac{\sigma(x_p, s_p, v&#39;)}{\sigma(x_p, s_p, v_p)} \times w_p\)</span></p>
<h1 id="code-architecture">Code architecture</h1>
<figure>
<img src="codestruct.png" alt="Code architecture" id="fig:code" /><figcaption>Code architecture<span label="fig:code"></span></figcaption>
</figure>
<p>The figure <a href="#fig:code" data-reference-type="ref" data-reference="fig:code">1</a> represent the structure of our implementation. The <strong>Main program</strong> is used for several computation, <strong>Domain</strong> set up the boundary condition, initial condition and the sampling of <span class="math inline">\(v\)</span> and <span class="math inline">\(\tau\)</span>. <strong>Particles</strong> set up the semi analog scheme,<strong>Population</strong> Move all the particles and <strong>parameters</strong> initialize the parameters.</p>
<h4 id="regression-suite">Regression suite</h4>
<p>In order to facilitate the implementation and the improvement of the code, a regression suite has been established. The script <strong>BNR.py</strong> execute all the test sequentially and relative message to each test are print in the console. The coder can then decide if the test are passed or not.</p>
<h4 id="section-15"></h4>
<p>The reproducibility test compute 2 times the solution for one <span class="math inline">\(t\)</span> fixed and look if the both results are similar or not.</p>
<h4 id="section-16"></h4>
<p>The sampling test a high number of speed <span class="math inline">\(V_p\)</span> looking if this speed is on the unit sphere by using the Kolmogorov-Smirnov law.</p>
<h4 id="section-17"></h4>
<p>The advection test used a computation of the main program with <span class="math inline">\(sigma_t=0\)</span> and <span class="math inline">\(\sigma_s=0\)</span>. We are in the case of the advection described previsously and we compare the result computed with the known exact-solution.</p>
<h4 id="section-18"></h4>
<p>The exponential test used a computation of the main program with <span class="math inline">\(sigma_t\)</span> and <span class="math inline">\(\sigma_s\)</span> constant. With this configuration we can calculate the integrale of the exact solution as :</p>
<p><span class="math display">\[\int_{\Omega} U(t)d_{x}=\int_{\Omega} U_0 d_{x} ~ e^{-v(\sigma_t-\sigma_s)t}\]</span></p>
<p>and compare to the computed solution.</p>
<h1 id="conclusion">Conclusion</h1>
<p>First and foremost, we would like to express our sincere appreciation to our supervisor, Gael Poette, whose exceptional support was evident through his constant presence and responsiveness throughout our research.</p>
<p>This project provided a unique opportunity to work on Monte Carlo methods. Accustomed to working with partial differential equations, the adoption of this new method for solving equations presented a stimulating challenge over the course of these four months. Collaborating in a group of five within such a limited timeframe posed its own set of challenges, but we successfully brought the project to completion.</p>
<p>The work we accomplished enabled us to gain a deeper understanding of high-dimensional equation solving, a skill set that will undoubtedly prove invaluable in our future professional lifes.</p>
